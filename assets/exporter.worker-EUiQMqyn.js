var N=(t=>(t.MainSeqStar="MainSeqStar",t.GiantStar="GiantStar",t.WhiteDwarf="WhiteDwarf",t.NeutronStar="NeutronStar",t.BlackHole="BlackHole",t))(N||{}),M=(t=>(t.M="M",t.K="K",t.G="G",t.F="F",t.A="A",t.B="B",t.O="O",t.X="X",t))(M||{}),s=(t=>(t.None="None",t.Iron="Iron",t.Copper="Copper",t.Silicium="Silicium",t.Titanium="Titanium",t.Stone="Stone",t.Coal="Coal",t.Oil="Oil",t.Fireice="Fireice",t.Diamond="Diamond",t.Fractal="Fractal",t.Crysrub="Crysrub",t.Grat="Grat",t.Bamboo="Bamboo",t.Mag="Mag",t))(s||{}),O=(t=>(t.Eq="Eq",t.Neq="Neq",t.Lt="Lt",t.Lte="Lte",t.Gt="Gt",t.Gte="Gte",t))(O||{}),x=(t=>(t[t.None=0]="None",t[t.Fireice=1011]="Fireice",t[t.Hydrogen=1120]="Hydrogen",t[t.Deuterium=1121]="Deuterium",t))(x||{}),q=(t=>(t[t.None=0]="None",t[t.Ice=-2]="Ice",t[t.Lava=-1]="Lava",t[t.Water=1e3]="Water",t[t.Sulfur=1116]="Sulfur",t))(q||{});const T={[s.None]:"",[s.Iron]:"Iron Ore",[s.Copper]:"Copper Ore",[s.Silicium]:"Silicon Ore",[s.Titanium]:"Titanium Ore",[s.Stone]:"Stone",[s.Coal]:"Coal",[s.Oil]:"Crude Oil",[s.Fireice]:"Fire Ice",[s.Diamond]:"Kimberlite Ore",[s.Fractal]:"Fractal Silicon",[s.Crysrub]:"Organic Crystal",[s.Grat]:"Grating Crystal",[s.Bamboo]:"Stalagmite Crystal",[s.Mag]:"Unipolar Magnet"},V={[x.None]:"",[x.Fireice]:"Fire Ice",[x.Hydrogen]:"Hydrogen",[x.Deuterium]:"Deuterium"},$=[s.Iron,s.Copper,s.Silicium,s.Titanium,s.Stone,s.Coal,s.Oil,s.Fireice,s.Diamond,s.Fractal,s.Crysrub,s.Grat,s.Bamboo,s.Mag],H=[x.Fireice,x.Hydrogen,x.Deuterium];function Z(t){const n=t.minGroup*t.minPatch*t.minAmount,e=t.maxGroup*t.maxPatch*t.maxAmount,r=(t.minGroup+t.maxGroup)*(t.minPatch+t.maxPatch)*(t.minAmount+t.maxAmount)/8;return{veinType:t.veinType,min:n,max:e,avg:r}}const U=["I","II","III","IV","V","VI"],tt={1:"Mariterra",2:"Gas Giant",3:"Gas Giant",4:"Ice Giant",5:"Ice Giant",6:"Scorchedia",7:"Geloterra",8:"Tropicana",9:"Lava",10:"Glacieon",11:"Desolus",12:"Gobi",13:"Sulfuria",14:"Crimsonis",15:"Prairiea",16:"Aquatica",17:"Halitum",18:"Sakura Ocean",19:"Cyclonius",20:"Maroonfrost",21:"Gas Giant",22:"Savanna",23:"Onyxtopia",24:"Icefrostia",25:"Pandora Swamp"};O.Eq+"",O.Neq+"",O.Gt+"",O.Gte+"",O.Lt+"",O.Lte+"";function nt(t){if(t.type===N.GiantStar)switch(t.spectr){case M.M:case M.K:return"Red Giant";case M.G:case M.F:return"Yellow Giant";case M.A:return"White Giant";default:return"Blue Giant"}else return t.type===N.WhiteDwarf?"White Dwarf":t.type===N.NeutronStar?"Neutron Star":t.type===N.BlackHole?"Black Hole":t.spectr+" type Star"}function et([t,n,e]){return Math.sqrt(t*t+n*n+e*e)}function K([t,n,e],[r,o,f]){const u=t-r,_=n-o,w=e-f;return Math.sqrt(u*u+_*_+w*w)}function rt(t,n){return n.map(e=>K(t,e)).reduce((e,r)=>e<r?e:r,1/0)}function ot(t,n){return n.map(e=>K(t,e)).reduce((e,r)=>e>r?e:r,-1/0)}var l=(t=>(t.Seed="Seed",t.Index="Index",t.Name="Name",t.PositionX="X",t.PositionY="Y",t.PositionZ="Z",t.Mass="Mass",t.Age="Age",t.Temperature="Temperature",t.Type="Type",t.Spectr="Spectral Class",t.Luminosity="Luminosity",t.Radius="Radius",t.DysonRadius="Max Dyson Sphere Radius",t.DistanceFromBirth="Distance From Start",t.DistanceFromNearestX="Distance From Nearest X Star",t.DistanceFromFurthestX="Distance From Furthest X Star",t))(l||{});const it=["Seed","Index","Name","Type","Spectral Class","Luminosity","X","Y","Z","Distance From Start","Distance From Nearest X Star","Distance From Furthest X Star","Radius","Max Dyson Sphere Radius","Mass","Age","Temperature"];var d=(t=>(t.Seed="Seed",t.Index="Index",t.Name="Name",t.Theme="Theme",t.Orbiting="Orbiting",t.TidallyLocked="Tidally Locked",t.OrbitRadius="Orbit Radius",t.OrbitInclination="Orbit Inclination",t.OrbitLongitude="Orbit Longitude",t.OrbitalPeriod="Orbital Period",t.OrbitPhase="Orbit Phase",t.Obliquity="Obliquity",t.RotationPeriod="Rotation Period",t.RotationPhase="Rotation Phase",t.Wind="Wind Power",t.Luminosity="Solar Power",t))(d||{});const at=["Seed","Index","Name","Theme","Orbiting","Tidally Locked","Wind Power","Solar Power","Orbit Radius","Orbit Inclination","Orbit Longitude","Orbital Period","Orbit Phase","Obliquity","Rotation Period","Rotation Phase"];[...$.flatMap(t=>{const n=T[t];return[`${n} (Avg)`,`${n} (Min)`,`${n} (Max)`]}),...H.map(t=>V[t])];let g;const h=new Array(128).fill(void 0);h.push(void 0,null,!0,!1);function i(t){return h[t]}let k=h.length;function st(t){t<132||(h[t]=k,k=t)}function p(t){const n=i(t);return st(t),n}let j=0,L=null;function C(){return(L===null||L.byteLength===0)&&(L=new Uint8Array(g.memory.buffer)),L}const v=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ct=typeof v.encodeInto=="function"?function(t,n){return v.encodeInto(t,n)}:function(t,n){const e=v.encode(t);return n.set(e),{read:t.length,written:e.length}};function Y(t,n,e){if(e===void 0){const _=v.encode(t),w=n(_.length,1)>>>0;return C().subarray(w,w+_.length).set(_),j=_.length,w}let r=t.length,o=n(r,1)>>>0;const f=C();let u=0;for(;u<r;u++){const _=t.charCodeAt(u);if(_>127)break;f[o+u]=_}if(u!==r){u!==0&&(t=t.slice(u)),o=e(o,r,r=u+t.length*3,1)>>>0;const _=C().subarray(o+u,o+r),w=ct(t,_);u+=w.written}return j=u,o}function D(t){return t==null}let R=null;function y(){return(R===null||R.byteLength===0)&&(R=new Int32Array(g.memory.buffer)),R}function a(t){k===h.length&&h.push(h.length+1);const n=k;return k=h[n],h[n]=t,n}let G=null;function ut(){return(G===null||G.byteLength===0)&&(G=new Float64Array(g.memory.buffer)),G}const z=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&z.decode();function B(t,n){return t=t>>>0,z.decode(C().subarray(t,t+n))}let P=null;function ft(){return(P===null||P.byteLength===0)&&(P=new BigInt64Array(g.memory.buffer)),P}function X(t){const n=typeof t;if(n=="number"||n=="boolean"||t==null)return`${t}`;if(n=="string")return`"${t}"`;if(n=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(n=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let f="[";o>0&&(f+=X(t[0]));for(let u=1;u<o;u++)f+=", "+X(t[u]);return f+="]",f}const e=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(e.length>1)r=e[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function _t(t,n,e,r){const o={a:t,b:n,cnt:1,dtor:e},f=(...u)=>{o.cnt++;const _=o.a;o.a=0;try{return r(_,o.b,...u)}finally{--o.cnt===0?g.__wbindgen_export_2.get(o.dtor)(_,o.b):o.a=_}};return f.original=o,f}function bt(t,n,e){g.wasm_bindgen__convert__closures__invoke1_mut__h7f338d92eec20e44(t,n,a(e))}function gt(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.generate(o,a(t));var n=y()[o/4+0],e=y()[o/4+1],r=y()[o/4+2];if(r)throw p(e);return p(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function I(t,n){try{return t.apply(this,n)}catch(e){g.__wbindgen_exn_store(a(e))}}async function lt(t,n){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,n)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const e=await t.arrayBuffer();return await WebAssembly.instantiate(e,n)}else{const e=await WebAssembly.instantiate(t,n);return e instanceof WebAssembly.Instance?{instance:e,module:t}:e}}function dt(){const t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(n){p(n)},t.wbg.__wbindgen_string_get=function(n,e){const r=i(e),o=typeof r=="string"?r:void 0;var f=D(o)?0:Y(o,g.__wbindgen_malloc,g.__wbindgen_realloc),u=j;y()[n/4+1]=u,y()[n/4+0]=f},t.wbg.__wbindgen_cb_drop=function(n){const e=p(n).original;return e.cnt--==1?(e.a=0,!0):!1},t.wbg.__wbindgen_boolean_get=function(n){const e=i(n);return typeof e=="boolean"?e?1:0:2},t.wbg.__wbindgen_is_bigint=function(n){return typeof i(n)=="bigint"},t.wbg.__wbindgen_bigint_from_i64=function(n){return a(n)},t.wbg.__wbindgen_jsval_eq=function(n,e){return i(n)===i(e)},t.wbg.__wbindgen_bigint_from_u64=function(n){const e=BigInt.asUintN(64,n);return a(e)},t.wbg.__wbindgen_number_get=function(n,e){const r=i(e),o=typeof r=="number"?r:void 0;ut()[n/8+1]=D(o)?0:o,y()[n/4+0]=!D(o)},t.wbg.__wbindgen_is_object=function(n){const e=i(n);return typeof e=="object"&&e!==null},t.wbg.__wbindgen_in=function(n,e){return i(n)in i(e)},t.wbg.__wbindgen_is_undefined=function(n){return i(n)===void 0},t.wbg.__wbg_found_4f0f08ab9814b693=function(n){const e=worldgen.found(p(n));return a(e)},t.wbg.__wbindgen_is_string=function(n){return typeof i(n)=="string"},t.wbg.__wbindgen_error_new=function(n,e){const r=new Error(B(n,e));return a(r)},t.wbg.__wbindgen_object_clone_ref=function(n){const e=i(n);return a(e)},t.wbg.__wbindgen_jsval_loose_eq=function(n,e){return i(n)==i(e)},t.wbg.__wbindgen_as_number=function(n){return+i(n)},t.wbg.__wbindgen_number_new=function(n){return a(n)},t.wbg.__wbindgen_string_new=function(n,e){const r=B(n,e);return a(r)},t.wbg.__wbg_getwithrefkey_4a92a5eca60879b9=function(n,e){const r=i(n)[i(e)];return a(r)},t.wbg.__wbg_set_9182712abebf82ef=function(n,e,r){i(n)[p(e)]=p(r)},t.wbg.__wbg_queueMicrotask_4d890031a6a5a50c=function(n){queueMicrotask(i(n))},t.wbg.__wbg_queueMicrotask_adae4bc085237231=function(n){const e=i(n).queueMicrotask;return a(e)},t.wbg.__wbindgen_is_function=function(n){return typeof i(n)=="function"},t.wbg.__wbg_get_f01601b5a68d10e3=function(n,e){const r=i(n)[e>>>0];return a(r)},t.wbg.__wbg_length_1009b1af0c481d7b=function(n){return i(n).length},t.wbg.__wbg_new_ffc6d4d085022169=function(){const n=new Array;return a(n)},t.wbg.__wbg_newnoargs_c62ea9419c21fbac=function(n,e){const r=new Function(B(n,e));return a(r)},t.wbg.__wbg_new_bfd4534b584a9593=function(){return a(new Map)},t.wbg.__wbg_next_9b877f231f476d01=function(n){const e=i(n).next;return a(e)},t.wbg.__wbg_next_6529ee0cca8d57ed=function(){return I(function(n){const e=i(n).next();return a(e)},arguments)},t.wbg.__wbg_done_5fe336b092d60cf2=function(n){return i(n).done},t.wbg.__wbg_value_0c248a78fdc8e19f=function(n){const e=i(n).value;return a(e)},t.wbg.__wbg_iterator_db7ca081358d4fb2=function(){return a(Symbol.iterator)},t.wbg.__wbg_get_7b48513de5dc5ea4=function(){return I(function(n,e){const r=Reflect.get(i(n),i(e));return a(r)},arguments)},t.wbg.__wbg_call_90c26b09837aba1c=function(){return I(function(n,e){const r=i(n).call(i(e));return a(r)},arguments)},t.wbg.__wbg_new_9fb8d994e1c0aaac=function(){const n=new Object;return a(n)},t.wbg.__wbg_self_f0e34d89f33b99fd=function(){return I(function(){const n=self.self;return a(n)},arguments)},t.wbg.__wbg_window_d3b084224f4774d7=function(){return I(function(){const n=window.window;return a(n)},arguments)},t.wbg.__wbg_globalThis_9caa27ff917c6860=function(){return I(function(){const n=globalThis.globalThis;return a(n)},arguments)},t.wbg.__wbg_global_35dfdd59a4da3e74=function(){return I(function(){const n=global.global;return a(n)},arguments)},t.wbg.__wbg_set_f2740edb12e318cd=function(n,e,r){i(n)[e>>>0]=p(r)},t.wbg.__wbg_isArray_74fb723e24f76012=function(n){return Array.isArray(i(n))},t.wbg.__wbg_instanceof_ArrayBuffer_e7d53d51371448e2=function(n){let e;try{e=i(n)instanceof ArrayBuffer}catch{e=!1}return e},t.wbg.__wbg_set_d257c6f2da008627=function(n,e,r){const o=i(n).set(i(e),i(r));return a(o)},t.wbg.__wbg_isSafeInteger_f93fde0dca9820f8=function(n){return Number.isSafeInteger(i(n))},t.wbg.__wbg_entries_9e2e2aa45aa5094a=function(n){const e=Object.entries(i(n));return a(e)},t.wbg.__wbg_resolve_6e1c6553a82f85b7=function(n){const e=Promise.resolve(i(n));return a(e)},t.wbg.__wbg_then_3ab08cd4fbb91ae9=function(n,e){const r=i(n).then(i(e));return a(r)},t.wbg.__wbg_then_8371cc12cfedc5a2=function(n,e,r){const o=i(n).then(i(e),i(r));return a(o)},t.wbg.__wbg_buffer_a448f833075b71ba=function(n){const e=i(n).buffer;return a(e)},t.wbg.__wbg_new_8f67e318f15d7254=function(n){const e=new Uint8Array(i(n));return a(e)},t.wbg.__wbg_set_2357bf09366ee480=function(n,e,r){i(n).set(i(e),r>>>0)},t.wbg.__wbg_length_1d25fa9e4ac21ce7=function(n){return i(n).length},t.wbg.__wbg_instanceof_Uint8Array_bced6f43aed8c1aa=function(n){let e;try{e=i(n)instanceof Uint8Array}catch{e=!1}return e},t.wbg.__wbindgen_bigint_get_as_i64=function(n,e){const r=i(e),o=typeof r=="bigint"?r:void 0;ft()[n/8+1]=D(o)?BigInt(0):o,y()[n/4+0]=!D(o)},t.wbg.__wbindgen_debug_string=function(n,e){const r=X(i(e)),o=Y(r,g.__wbindgen_malloc,g.__wbindgen_realloc),f=j;y()[n/4+1]=f,y()[n/4+0]=o},t.wbg.__wbindgen_throw=function(n,e){throw new Error(B(n,e))},t.wbg.__wbindgen_memory=function(){const n=g.memory;return a(n)},t.wbg.__wbindgen_closure_wrapper503=function(n,e,r){const o=_t(n,e,158,bt);return a(o)},t}function wt(t,n){return g=t.exports,J.__wbindgen_wasm_module=n,P=null,G=null,R=null,L=null,g}async function J(t){if(g!==void 0)return g;typeof t>"u"&&(t=new URL("/DSP-Seed-Finder/assets/dsp_seed_finder_bg-IpZeG5CY.wasm",import.meta.url));const n=dt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:e,module:r}=await lt(await t,n);return wt(e,r)}function b(t,n){const e=Math.pow(10,n);return Math.round(t*e)/e}const mt=J(),E={[l.Seed]:t=>t.seed,[l.Index]:(t,n)=>n.index+1,[l.Name]:(t,n)=>n.name,[l.PositionX]:(t,n)=>b(n.position[0],6),[l.PositionY]:(t,n)=>b(n.position[1],6),[l.PositionZ]:(t,n)=>b(n.position[2],6),[l.Mass]:(t,n)=>b(n.mass,4),[l.Age]:(t,n)=>b(n.age*n.lifetime,4),[l.Temperature]:(t,n)=>b(n.temperature,4),[l.Type]:(t,n)=>nt(n),[l.Spectr]:(t,n)=>n.spectr,[l.Luminosity]:(t,n)=>b(n.luminosity,3),[l.Radius]:(t,n)=>b(n.radius*1600,0),[l.DysonRadius]:(t,n)=>b(n.dysonRadius,0),[l.DistanceFromBirth]:(t,n)=>b(et(n.position),3)},F={[d.Seed]:t=>t.seed,[d.Index]:(t,n)=>n.index+1,[d.Name]:(t,n,e)=>`${n.name} ${U[e.index]}`,[d.Theme]:(t,n,e)=>tt[e.theme.id],[d.Orbiting]:(t,n,e)=>e.orbitAround!=null?`${n.name} ${U[n.planets[e.orbitAround].index]}`:"",[d.TidallyLocked]:(t,n,e)=>e.orbitalPeriod===e.rotationPeriod,[d.Wind]:(t,n,e)=>b(e.theme.wind*100,0),[d.Luminosity]:(t,n,e)=>b(e.luminosity*100,0),[d.OrbitRadius]:(t,n,e)=>b(e.orbitRadius,4),[d.OrbitInclination]:(t,n,e)=>b(e.orbitInclination,4),[d.OrbitLongitude]:(t,n,e)=>b(e.orbitLongitude,4),[d.OrbitalPeriod]:(t,n,e)=>b(e.orbitalPeriod,4),[d.OrbitPhase]:(t,n,e)=>b(e.orbitPhase,4),[d.Obliquity]:(t,n,e)=>b(e.obliquity,4),[d.RotationPeriod]:(t,n,e)=>b(e.rotationPeriod,4),[d.RotationPhase]:(t,n,e)=>b(e.rotationPhase,4)};function Q(t){return t.veinType===s.Oil?{veinType:s.Oil,min:t.min*4e-5,max:t.max*4e-5,avg:t.avg*4e-5}:t}function yt(t,n){var u,_,w,A;const e=[],r=t.stars.map(c=>c.position);for(const c of it)switch(c){case l.DistanceFromNearestX:e.push(b(rt(n.position,r),4));break;case l.DistanceFromFurthestX:e.push(b(ot(n.position,r),4));break;default:e.push((u=E[c])==null?void 0:u.call(E,t,n));break}const o={};for(const c of n.planets)for(const m of c.veins){const S=Q(Z(m)),W=o[m.veinType];W?(W.min+=S.min,W.max+=S.max,W.avg+=S.avg):o[m.veinType]=S}for(const c of $)e.push(((_=o[c])==null?void 0:_.avg)??0),e.push(((w=o[c])==null?void 0:w.min)??0),e.push(((A=o[c])==null?void 0:A.max)??0);e.push(!!n.planets.find(c=>c.theme.waterItemId===q.Water)),e.push(!!n.planets.find(c=>c.theme.waterItemId===q.Sulfur));const f={};for(const c of n.planets)for(const[m,S]of c.gases)f[m]??(f[m]=0),f[m]+=S;for(const c of H)e.push(b(f[c]??0,4));return e}function ht(t,n,e){var u,_,w,A;const r=[];for(const c of at)r.push((u=F[c])==null?void 0:u.call(F,t,n,e));const o={};for(const c of e.veins)o[c.veinType]=Q(Z(c));for(const c of $)r.push(((_=o[c])==null?void 0:_.avg)??0),r.push(((w=o[c])==null?void 0:w.min)??0),r.push(((A=o[c])==null?void 0:A.max)??0);r.push(e.theme.waterItemId===q.Water),r.push(e.theme.waterItemId===q.Sulfur);const f={};for(const[c,m]of e.gases)f[c]=m;for(const c of H)r.push(b(f[c]??0,4));return r}function pt(t,n,e){let r=t.stars;return e||(r=r.filter(o=>n.includes(o.index))),{seed:t.seed,stars:r.map(o=>yt(t,o)),planets:r.flatMap(o=>o.planets.map(f=>ht(t,o,f)))}}self.onmessage=t=>{const{seed:n,indexes:e,resourceMultiplier:r=1,starCount:o=64,exportAllStars:f}=t.data;mt.then(()=>{const u=gt({seed:n,starCount:o,resourceMultiplier:r}),_=pt(u,e,f);self.postMessage(_)})};
