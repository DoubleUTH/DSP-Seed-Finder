var S=(t=>(t.MainSeqStar="MainSeqStar",t.GiantStar="GiantStar",t.WhiteDwarf="WhiteDwarf",t.NeutronStar="NeutronStar",t.BlackHole="BlackHole",t))(S||{}),A=(t=>(t.M="M",t.K="K",t.G="G",t.F="F",t.A="A",t.B="B",t.O="O",t.X="X",t))(A||{}),c=(t=>(t.None="None",t.Iron="Iron",t.Copper="Copper",t.Silicium="Silicium",t.Titanium="Titanium",t.Stone="Stone",t.Coal="Coal",t.Oil="Oil",t.Fireice="Fireice",t.Diamond="Diamond",t.Fractal="Fractal",t.Crysrub="Crysrub",t.Grat="Grat",t.Bamboo="Bamboo",t.Mag="Mag",t))(c||{}),O=(t=>(t.Eq="Eq",t.Neq="Neq",t.Lt="Lt",t.Lte="Lte",t.Gt="Gt",t.Gte="Gte",t))(O||{}),x=(t=>(t[t.None=0]="None",t[t.Fireice=1011]="Fireice",t[t.Hydrogen=1120]="Hydrogen",t[t.Deuterium=1121]="Deuterium",t))(x||{}),q=(t=>(t[t.None=0]="None",t[t.Ice=-2]="Ice",t[t.Lava=-1]="Lava",t[t.Water=1e3]="Water",t[t.Sulfur=1116]="Sulfur",t))(q||{});const T={[c.None]:"",[c.Iron]:"Iron Ore",[c.Copper]:"Copper Ore",[c.Silicium]:"Silicon Ore",[c.Titanium]:"Titanium Ore",[c.Stone]:"Stone",[c.Coal]:"Coal",[c.Oil]:"Crude Oil",[c.Fireice]:"Fire Ice",[c.Diamond]:"Kimberlite Ore",[c.Fractal]:"Fractal Silicon",[c.Crysrub]:"Organic Crystal",[c.Grat]:"Grating Crystal",[c.Bamboo]:"Stalagmite Crystal",[c.Mag]:"Unipolar Magnet"},V={[x.None]:"",[x.Fireice]:"Fire Ice",[x.Hydrogen]:"Hydrogen",[x.Deuterium]:"Deuterium"},$=[c.Iron,c.Copper,c.Silicium,c.Titanium,c.Stone,c.Coal,c.Oil,c.Fireice,c.Diamond,c.Fractal,c.Crysrub,c.Grat,c.Bamboo,c.Mag],H=[x.Fireice,x.Hydrogen,x.Deuterium];function K(t){const e=t.minGroup*t.minPatch*t.minAmount,n=t.maxGroup*t.maxPatch*t.maxAmount,r=(t.minGroup+t.maxGroup)*(t.minPatch+t.maxPatch)*(t.minAmount+t.maxAmount)/8;return{veinType:t.veinType,min:e,max:n,avg:r}}const U=["I","II","III","IV","V","VI"],tt={1:"Mariterra",2:"Gas Giant",3:"Gas Giant",4:"Ice Giant",5:"Ice Giant",6:"Scorchedia",7:"Geloterra",8:"Tropicana",9:"Lava",10:"Glacieon",11:"Desolus",12:"Gobi",13:"Sulfuria",14:"Crimsonis",15:"Prairiea",16:"Aquatica",17:"Halitum",18:"Sakura Ocean",19:"Cyclonius",20:"Maroonfrost",21:"Gas Giant",22:"Savanna",23:"Onyxtopia",24:"Icefrostia",25:"Pandora Swamp"};O.Eq+"",O.Neq+"",O.Gt+"",O.Gte+"",O.Lt+"",O.Lte+"";function et(t){if(t.type===S.GiantStar)switch(t.spectr){case A.M:case A.K:return"Red Giant";case A.G:case A.F:return"Yellow Giant";case A.A:return"White Giant";default:return"Blue Giant"}else return t.type===S.WhiteDwarf?"White Dwarf":t.type===S.NeutronStar?"Neutron Star":t.type===S.BlackHole?"Black Hole":t.spectr+" type Star"}function nt([t,e,n]){return Math.sqrt(t*t+e*e+n*n)}function Z([t,e,n],[r,o,f]){const u=t-r,_=e-o,w=n-f;return Math.sqrt(u*u+_*_+w*w)}function rt(t,e){return e.map(n=>Z(t,n)).reduce((n,r)=>n<r?n:r,1/0)}function ot(t,e){return e.map(n=>Z(t,n)).reduce((n,r)=>n>r?n:r,-1/0)}var l=(t=>(t.Seed="Seed",t.Index="Index",t.Name="Name",t.PositionX="X",t.PositionY="Y",t.PositionZ="Z",t.Mass="Mass",t.Age="Age",t.Temperature="Temperature",t.Type="Type",t.Spectr="Spectral Class",t.Luminosity="Luminosity",t.Radius="Radius",t.DysonRadius="Max Dyson Sphere Radius",t.DistanceFromBirth="Distance From Start",t.DistanceFromNearestX="Distance From Nearest X Star",t.DistanceFromFurthestX="Distance From Furthest X Star",t))(l||{});const it=["Seed","Index","Name","Type","Spectral Class","Luminosity","X","Y","Z","Distance From Start","Distance From Nearest X Star","Distance From Furthest X Star","Radius","Max Dyson Sphere Radius","Mass","Age","Temperature"];var d=(t=>(t.Seed="Seed",t.Index="Index",t.Name="Name",t.Theme="Theme",t.Orbiting="Orbiting",t.TidallyLocked="Tidally Locked",t.OrbitRadius="Orbit Radius",t.OrbitInclination="Orbit Inclination",t.OrbitLongitude="Orbit Longitude",t.OrbitalPeriod="Orbital Period",t.OrbitPhase="Orbit Phase",t.Obliquity="Obliquity",t.RotationPeriod="Rotation Period",t.RotationPhase="Rotation Phase",t.Wind="Wind Power",t.Luminosity="Solar Power",t))(d||{});const at=["Seed","Index","Name","Theme","Orbiting","Tidally Locked","Wind Power","Solar Power","Orbit Radius","Orbit Inclination","Orbit Longitude","Orbital Period","Orbit Phase","Obliquity","Rotation Period","Rotation Phase"];[...$.flatMap(t=>{const e=T[t];return[`${e} (Avg)`,`${e} (Min)`,`${e} (Max)`]}),...H.map(t=>V[t])];let g;const h=new Array(128).fill(void 0);h.push(void 0,null,!0,!1);function i(t){return h[t]}let P=h.length;function st(t){t<132||(h[t]=P,P=t)}function p(t){const e=i(t);return st(t),e}let j=0,L=null;function v(){return(L===null||L.byteLength===0)&&(L=new Uint8Array(g.memory.buffer)),L}const C=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ct=typeof C.encodeInto=="function"?function(t,e){return C.encodeInto(t,e)}:function(t,e){const n=C.encode(t);return e.set(n),{read:t.length,written:n.length}};function Y(t,e,n){if(n===void 0){const _=C.encode(t),w=e(_.length,1)>>>0;return v().subarray(w,w+_.length).set(_),j=_.length,w}let r=t.length,o=e(r,1)>>>0;const f=v();let u=0;for(;u<r;u++){const _=t.charCodeAt(u);if(_>127)break;f[o+u]=_}if(u!==r){u!==0&&(t=t.slice(u)),o=n(o,r,r=u+t.length*3,1)>>>0;const _=v().subarray(o+u,o+r),w=ct(t,_);u+=w.written}return j=u,o}function N(t){return t==null}let R=null;function y(){return(R===null||R.byteLength===0)&&(R=new Int32Array(g.memory.buffer)),R}function a(t){P===h.length&&h.push(h.length+1);const e=P;return P=h[e],h[e]=t,e}let k=null;function ut(){return(k===null||k.byteLength===0)&&(k=new Float64Array(g.memory.buffer)),k}const z=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&z.decode();function B(t,e){return t=t>>>0,z.decode(v().subarray(t,t+e))}let G=null;function ft(){return(G===null||G.byteLength===0)&&(G=new BigInt64Array(g.memory.buffer)),G}function X(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let f="[";o>0&&(f+=X(t[0]));for(let u=1;u<o;u++)f+=", "+X(t[u]);return f+="]",f}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function _t(t,e,n,r){const o={a:t,b:e,cnt:1,dtor:n},f=(...u)=>{o.cnt++;const _=o.a;o.a=0;try{return r(_,o.b,...u)}finally{--o.cnt===0?g.__wbindgen_export_2.get(o.dtor)(_,o.b):o.a=_}};return f.original=o,f}function bt(t,e,n){g.wasm_bindgen__convert__closures__invoke1_mut__h7f338d92eec20e44(t,e,a(n))}function gt(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.generate(o,a(t));var e=y()[o/4+0],n=y()[o/4+1],r=y()[o/4+2];if(r)throw p(n);return p(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function I(t,e){try{return t.apply(this,e)}catch(n){g.__wbindgen_exn_store(a(n))}}async function lt(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function dt(){const t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(e){p(e)},t.wbg.__wbindgen_string_get=function(e,n){const r=i(n),o=typeof r=="string"?r:void 0;var f=N(o)?0:Y(o,g.__wbindgen_malloc,g.__wbindgen_realloc),u=j;y()[e/4+1]=u,y()[e/4+0]=f},t.wbg.__wbindgen_cb_drop=function(e){const n=p(e).original;return n.cnt--==1?(n.a=0,!0):!1},t.wbg.__wbindgen_boolean_get=function(e){const n=i(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_is_bigint=function(e){return typeof i(e)=="bigint"},t.wbg.__wbindgen_bigint_from_i64=function(e){return a(e)},t.wbg.__wbindgen_jsval_eq=function(e,n){return i(e)===i(n)},t.wbg.__wbindgen_bigint_from_u64=function(e){const n=BigInt.asUintN(64,e);return a(n)},t.wbg.__wbindgen_number_get=function(e,n){const r=i(n),o=typeof r=="number"?r:void 0;ut()[e/8+1]=N(o)?0:o,y()[e/4+0]=!N(o)},t.wbg.__wbindgen_is_object=function(e){const n=i(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_in=function(e,n){return i(e)in i(n)},t.wbg.__wbindgen_is_undefined=function(e){return i(e)===void 0},t.wbg.__wbg_found_4f0f08ab9814b693=function(e){const n=worldgen.found(p(e));return a(n)},t.wbg.__wbindgen_is_string=function(e){return typeof i(e)=="string"},t.wbg.__wbindgen_error_new=function(e,n){const r=new Error(B(e,n));return a(r)},t.wbg.__wbindgen_object_clone_ref=function(e){const n=i(e);return a(n)},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return i(e)==i(n)},t.wbg.__wbindgen_as_number=function(e){return+i(e)},t.wbg.__wbindgen_number_new=function(e){return a(e)},t.wbg.__wbindgen_string_new=function(e,n){const r=B(e,n);return a(r)},t.wbg.__wbg_getwithrefkey_4a92a5eca60879b9=function(e,n){const r=i(e)[i(n)];return a(r)},t.wbg.__wbg_set_9182712abebf82ef=function(e,n,r){i(e)[p(n)]=p(r)},t.wbg.__wbg_queueMicrotask_4d890031a6a5a50c=function(e){queueMicrotask(i(e))},t.wbg.__wbg_queueMicrotask_adae4bc085237231=function(e){const n=i(e).queueMicrotask;return a(n)},t.wbg.__wbindgen_is_function=function(e){return typeof i(e)=="function"},t.wbg.__wbg_get_f01601b5a68d10e3=function(e,n){const r=i(e)[n>>>0];return a(r)},t.wbg.__wbg_length_1009b1af0c481d7b=function(e){return i(e).length},t.wbg.__wbg_new_ffc6d4d085022169=function(){const e=new Array;return a(e)},t.wbg.__wbg_newnoargs_c62ea9419c21fbac=function(e,n){const r=new Function(B(e,n));return a(r)},t.wbg.__wbg_new_bfd4534b584a9593=function(){return a(new Map)},t.wbg.__wbg_next_9b877f231f476d01=function(e){const n=i(e).next;return a(n)},t.wbg.__wbg_next_6529ee0cca8d57ed=function(){return I(function(e){const n=i(e).next();return a(n)},arguments)},t.wbg.__wbg_done_5fe336b092d60cf2=function(e){return i(e).done},t.wbg.__wbg_value_0c248a78fdc8e19f=function(e){const n=i(e).value;return a(n)},t.wbg.__wbg_iterator_db7ca081358d4fb2=function(){return a(Symbol.iterator)},t.wbg.__wbg_get_7b48513de5dc5ea4=function(){return I(function(e,n){const r=Reflect.get(i(e),i(n));return a(r)},arguments)},t.wbg.__wbg_call_90c26b09837aba1c=function(){return I(function(e,n){const r=i(e).call(i(n));return a(r)},arguments)},t.wbg.__wbg_new_9fb8d994e1c0aaac=function(){const e=new Object;return a(e)},t.wbg.__wbg_self_f0e34d89f33b99fd=function(){return I(function(){const e=self.self;return a(e)},arguments)},t.wbg.__wbg_window_d3b084224f4774d7=function(){return I(function(){const e=window.window;return a(e)},arguments)},t.wbg.__wbg_globalThis_9caa27ff917c6860=function(){return I(function(){const e=globalThis.globalThis;return a(e)},arguments)},t.wbg.__wbg_global_35dfdd59a4da3e74=function(){return I(function(){const e=global.global;return a(e)},arguments)},t.wbg.__wbg_set_f2740edb12e318cd=function(e,n,r){i(e)[n>>>0]=p(r)},t.wbg.__wbg_isArray_74fb723e24f76012=function(e){return Array.isArray(i(e))},t.wbg.__wbg_instanceof_ArrayBuffer_e7d53d51371448e2=function(e){let n;try{n=i(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_set_d257c6f2da008627=function(e,n,r){const o=i(e).set(i(n),i(r));return a(o)},t.wbg.__wbg_isSafeInteger_f93fde0dca9820f8=function(e){return Number.isSafeInteger(i(e))},t.wbg.__wbg_entries_9e2e2aa45aa5094a=function(e){const n=Object.entries(i(e));return a(n)},t.wbg.__wbg_resolve_6e1c6553a82f85b7=function(e){const n=Promise.resolve(i(e));return a(n)},t.wbg.__wbg_then_3ab08cd4fbb91ae9=function(e,n){const r=i(e).then(i(n));return a(r)},t.wbg.__wbg_then_8371cc12cfedc5a2=function(e,n,r){const o=i(e).then(i(n),i(r));return a(o)},t.wbg.__wbg_buffer_a448f833075b71ba=function(e){const n=i(e).buffer;return a(n)},t.wbg.__wbg_new_8f67e318f15d7254=function(e){const n=new Uint8Array(i(e));return a(n)},t.wbg.__wbg_set_2357bf09366ee480=function(e,n,r){i(e).set(i(n),r>>>0)},t.wbg.__wbg_length_1d25fa9e4ac21ce7=function(e){return i(e).length},t.wbg.__wbg_instanceof_Uint8Array_bced6f43aed8c1aa=function(e){let n;try{n=i(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbindgen_bigint_get_as_i64=function(e,n){const r=i(n),o=typeof r=="bigint"?r:void 0;ft()[e/8+1]=N(o)?BigInt(0):o,y()[e/4+0]=!N(o)},t.wbg.__wbindgen_debug_string=function(e,n){const r=X(i(n)),o=Y(r,g.__wbindgen_malloc,g.__wbindgen_realloc),f=j;y()[e/4+1]=f,y()[e/4+0]=o},t.wbg.__wbindgen_throw=function(e,n){throw new Error(B(e,n))},t.wbg.__wbindgen_memory=function(){const e=g.memory;return a(e)},t.wbg.__wbindgen_closure_wrapper503=function(e,n,r){const o=_t(e,n,158,bt);return a(o)},t}function wt(t,e){return g=t.exports,J.__wbindgen_wasm_module=e,G=null,k=null,R=null,L=null,g}async function J(t){if(g!==void 0)return g;typeof t>"u"&&(t=new URL("/DSP-Seed-Finder/assets/dsp_seed_finder_bg-xqWyp1Yl.wasm",import.meta.url));const e=dt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await lt(await t,e);return wt(n,r)}function b(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}const mt=J(),E={[l.Seed]:t=>t.seed,[l.Index]:(t,e)=>e.index+1,[l.Name]:(t,e)=>e.name,[l.PositionX]:(t,e)=>b(e.position[0],6),[l.PositionY]:(t,e)=>b(e.position[1],6),[l.PositionZ]:(t,e)=>b(e.position[2],6),[l.Mass]:(t,e)=>b(e.mass,4),[l.Age]:(t,e)=>b(e.age*e.lifetime,4),[l.Temperature]:(t,e)=>b(e.temperature,4),[l.Type]:(t,e)=>et(e),[l.Spectr]:(t,e)=>e.spectr,[l.Luminosity]:(t,e)=>b(e.luminosity,3),[l.Radius]:(t,e)=>b(e.radius*1600,0),[l.DysonRadius]:(t,e)=>b(e.dysonRadius,0),[l.DistanceFromBirth]:(t,e)=>b(nt(e.position),3)},F={[d.Seed]:t=>t.seed,[d.Index]:(t,e)=>e.index+1,[d.Name]:(t,e,n)=>`${e.name} ${U[n.index]}`,[d.Theme]:(t,e,n)=>tt[n.theme.id],[d.Orbiting]:(t,e,n)=>n.orbitAround!=null?`${e.name} ${U[e.planets[n.orbitAround].index]}`:"",[d.TidallyLocked]:(t,e,n)=>n.orbitalPeriod===n.rotationPeriod,[d.Wind]:(t,e,n)=>b(n.theme.wind*100,0),[d.Luminosity]:(t,e,n)=>b(n.luminosity*100,0),[d.OrbitRadius]:(t,e,n)=>b(n.orbitRadius,4),[d.OrbitInclination]:(t,e,n)=>b(n.orbitInclination,4),[d.OrbitLongitude]:(t,e,n)=>b(n.orbitLongitude,4),[d.OrbitalPeriod]:(t,e,n)=>b(n.orbitalPeriod,4),[d.OrbitPhase]:(t,e,n)=>b(n.orbitPhase,4),[d.Obliquity]:(t,e,n)=>b(n.obliquity,4),[d.RotationPeriod]:(t,e,n)=>b(n.rotationPeriod,4),[d.RotationPhase]:(t,e,n)=>b(n.rotationPhase,4)};function Q(t){return t.veinType===c.Oil?{veinType:c.Oil,min:t.min*4e-5,max:t.max*4e-5,avg:t.avg*4e-5}:t}function yt(t,e){var u,_,w,D;const n=[],r=t.stars.filter(s=>s.type===S.BlackHole||s.type===S.NeutronStar).map(s=>s.position);for(const s of it)switch(s){case l.DistanceFromNearestX:n.push(b(rt(e.position,r),4));break;case l.DistanceFromFurthestX:n.push(b(ot(e.position,r),4));break;default:n.push((u=E[s])==null?void 0:u.call(E,t,e));break}const o={};for(const s of e.planets)for(const m of s.veins){const M=Q(K(m)),W=o[m.veinType];W?(W.min+=M.min,W.max+=M.max,W.avg+=M.avg):o[m.veinType]=M}for(const s of $)n.push(((_=o[s])==null?void 0:_.avg)??0),n.push(((w=o[s])==null?void 0:w.min)??0),n.push(((D=o[s])==null?void 0:D.max)??0);n.push(!!e.planets.find(s=>s.theme.waterItemId===q.Water)),n.push(!!e.planets.find(s=>s.theme.waterItemId===q.Sulfur));const f={};for(const s of e.planets)for(const[m,M]of s.gases)f[m]??(f[m]=0),f[m]+=M;for(const s of H)n.push(b(f[s]??0,4));return n}function ht(t,e,n){var u,_,w,D;const r=[];for(const s of at)r.push((u=F[s])==null?void 0:u.call(F,t,e,n));const o={};for(const s of n.veins)o[s.veinType]=Q(K(s));for(const s of $)r.push(((_=o[s])==null?void 0:_.avg)??0),r.push(((w=o[s])==null?void 0:w.min)??0),r.push(((D=o[s])==null?void 0:D.max)??0);r.push(n.theme.waterItemId===q.Water),r.push(n.theme.waterItemId===q.Sulfur);const f={};for(const[s,m]of n.gases)f[s]=m;for(const s of H)r.push(b(f[s]??0,4));return r}function pt(t,e,n){let r=t.stars;return n||(r=r.filter(o=>e.includes(o.index))),{seed:t.seed,stars:r.map(o=>yt(t,o)),planets:r.flatMap(o=>o.planets.map(f=>ht(t,o,f)))}}self.onmessage=t=>{const{seed:e,indexes:n,resourceMultiplier:r=1,starCount:o=64,exportAllStars:f}=t.data;mt.then(()=>{const u=gt({seed:e,starCount:o,resourceMultiplier:r}),_=pt(u,n,f);self.postMessage(_)})};
